# CheckBL for check logs by black list and Geoip

This tool is written in python3. It's created by cybersecurity service of ANS ["Agence Numérique Santé" -> "Digital Health Agency"](https://cyberveille-sante.gouv.fr/). It's help you in analyse big log file contains IP v4 addresses.  It extract address ip from line and compare to bl and geoip (if you use option geoip).

## checkbl != Web_bl
Web_bl is same tool but to use in API web context.

## Require
  - pip3 install -r requirement.txt
  - [Register and download Geoip2 lite Country database in binary MMDB format](https://dev.maxmind.com/geoip/geoip2/geolite2/#Database)
  - Black list generated by script create-ipbl.py (generate_bl of this git repository)
  
## Let's Start
  - pip3 install -r requirement.txt
  - python3 checkbl.py --help
  - Exemple: checkbl.py -r -p /var/log/ -g Geolite2-country.mmdb -b db-ipbl.json -o badlog.json

## File result generated
  - Result in Json format. Below the fields in the result:
    - 'file_clean'
    - 'GeoIP' (GeoIP different of you country code matched)
      - {IP:Country_Code}
    - 'BL' (IP BL list)
      - {IP:BL_List_matched}
    - 'lines_suspect' (line match to BL or/and GeoIP)
      - {Number_of_Line: Line, BL: Match True or False, geoip: Country_Code}
    
## Exemple to use context
  - Log from VPN/Webmaib: check GEOIP acces and BL to find suspects with successful connections
  - Log from proxy web: check BL to find suspects connections (BOTNET...)
  - Log from web server: check BL to find suspects connections (web attack...)

